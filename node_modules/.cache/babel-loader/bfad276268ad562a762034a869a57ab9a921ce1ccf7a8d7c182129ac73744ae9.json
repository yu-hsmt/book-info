{"ast":null,"code":"// Utilities\nimport { effectScope, onScopeDispose, watch } from 'vue';\n\n// Types\n\nexport function useToggleScope(source, fn) {\n  var scope;\n  function start() {\n    scope = effectScope();\n    scope.run(function () {\n      return fn.length ? fn(function () {\n        var _scope;\n        (_scope = scope) === null || _scope === void 0 || _scope.stop();\n        start();\n      }) : fn();\n    });\n  }\n  watch(source, function (active) {\n    if (active && !scope) {\n      start();\n    } else if (!active) {\n      var _scope2;\n      (_scope2 = scope) === null || _scope2 === void 0 || _scope2.stop();\n      scope = undefined;\n    }\n  }, {\n    immediate: true\n  });\n  onScopeDispose(function () {\n    var _scope3;\n    (_scope3 = scope) === null || _scope3 === void 0 || _scope3.stop();\n  });\n}","map":{"version":3,"names":["effectScope","onScopeDispose","watch","useToggleScope","source","fn","scope","start","run","length","_scope","stop","active","_scope2","undefined","immediate","_scope3"],"sources":["../../src/composables/toggleScope.ts"],"sourcesContent":["// Utilities\nimport { effectScope, onScopeDispose, watch } from 'vue'\n\n// Types\nimport type { EffectScope, WatchSource } from 'vue'\n\nexport function useToggleScope (source: WatchSource<boolean>, fn: (reset: () => void) => void) {\n  let scope: EffectScope | undefined\n  function start () {\n    scope = effectScope()\n    scope.run(() => fn.length\n      ? fn(() => { scope?.stop(); start() })\n      : (fn as any)()\n    )\n  }\n\n  watch(source, active => {\n    if (active && !scope) {\n      start()\n    } else if (!active) {\n      scope?.stop()\n      scope = undefined\n    }\n  }, { immediate: true })\n\n  onScopeDispose(() => {\n    scope?.stop()\n  })\n}\n"],"mappings":"AAAA;AACA,SAASA,WAAW,EAAEC,cAAc,EAAEC,KAAK,QAAQ,KAAK;;AAExD;;AAGA,OAAO,SAASC,cAAcA,CAAEC,MAA4B,EAAEC,EAA+B,EAAE;EAC7F,IAAIC,KAA8B;EAClC,SAASC,KAAKA,CAAA,EAAI;IAChBD,KAAK,GAAGN,WAAW,CAAC,CAAC;IACrBM,KAAK,CAACE,GAAG,CAAC;MAAA,OAAMH,EAAE,CAACI,MAAM,GACrBJ,EAAE,CAAC,YAAM;QAAA,IAAAK,MAAA;QAAE,CAAAA,MAAA,GAAAJ,KAAK,cAAAI,MAAA,eAALA,MAAA,CAAOC,IAAI,CAAC,CAAC;QAAEJ,KAAK,CAAC,CAAC;MAAC,CAAC,CAAC,GACnCF,EAAE,CAAS,CAChB;IAAA,EAAC;EACH;EAEAH,KAAK,CAACE,MAAM,EAAE,UAAAQ,MAAM,EAAI;IACtB,IAAIA,MAAM,IAAI,CAACN,KAAK,EAAE;MACpBC,KAAK,CAAC,CAAC;IACT,CAAC,MAAM,IAAI,CAACK,MAAM,EAAE;MAAA,IAAAC,OAAA;MAClB,CAAAA,OAAA,GAAAP,KAAK,cAAAO,OAAA,eAALA,OAAA,CAAOF,IAAI,CAAC,CAAC;MACbL,KAAK,GAAGQ,SAAS;IACnB;EACF,CAAC,EAAE;IAAEC,SAAS,EAAE;EAAK,CAAC,CAAC;EAEvBd,cAAc,CAAC,YAAM;IAAA,IAAAe,OAAA;IACnB,CAAAA,OAAA,GAAAV,KAAK,cAAAU,OAAA,eAALA,OAAA,CAAOL,IAAI,CAAC,CAAC;EACf,CAAC,CAAC;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}